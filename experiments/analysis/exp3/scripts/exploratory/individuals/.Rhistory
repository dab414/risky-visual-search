library(tidyverse)
exp <- str_extract(getwd(), 'exp\\d[a-z]?')
d <- read.csv(paste0(here::here(), '/experiments/analysis/', exp, '/data/', exp, '_main_full.csv'))
demo <- read.csv(paste0(here::here(), '/experiments/analysis/', exp, '/data/', exp, 'demo.csv'))
demo <- read.csv(paste0(here::here(), '/experiments/analysis/', exp, '/data/', exp, '_demo.csv'))
N <- length(unique(d$subject))
head(d)
N
head(demo)
summary(demo$cog_effort_q10)
summary(factor(demo$cog_effort_q10))
response_code <- data.frame(text = c('neutral', 'somewhat_agree', 'somewhat_disagree', 'strongly_agree', 'strongly_disagree', ''), numeric = c(3, 4, 2, 5, 1, NA))
response_code
demo %>%
gather(question, response, cog_effort_q1:cog_effort_q18) %>%
select(subject, question, response) %>%
head()
demo %>%
gather(question, response, cog_effort_q1:cog_effort_q18) %>%
select(subject, question, response) %>%
inner_join(response_code) %>%
head()
reverse_items <- c(3,4,5,7,8,9,12,16,17)
response_code <- data.frame(response = c('neutral', 'somewhat_agree', 'somewhat_disagree', 'strongly_agree', 'strongly_disagree', ''), numeric = c(3, 4, 2, 5, 1, NA))
demo %>%
gather(question, response, cog_effort_q1:cog_effort_q18) %>%
select(subject, question, response) %>%
inner_join(response_code) %>%
head()
demo %>%
gather(question, response, cog_effort_q1:cog_effort_q18) %>%
select(subject, question, response) %>%
inner_join(response_code) %>%
filter(response=='') %>%
head()
reverse_items <- c(3,4,5,7,8,9,12,16,17)
response_code <- data.frame(response = c('neutral', 'somewhat_agree', 'somewhat_disagree', 'strongly_agree', 'strongly_disagree', ''), numeric = c(3, 4, 2, 5, 1, NA))
survey <- demo %>%
gather(question, response, cog_effort_q1:cog_effort_q18) %>%
select(subject, question, response) %>%
inner_join(response_code)
head(survey)
strsplit(survey$question[1], split='_')
unlist(strsplit(survey$question[1], split='_'))
unlist(strsplit(survey$question[1], split='_'))[3]
sub('.', '', unlist(strsplit(survey$question[1], split='_'))[3])
as.numeric(sub('.', '', unlist(strsplit(survey$question[1], split='_'))[3]))
survey %>%
mutate(question = parse_question(question)) %>%
head()
parse_question <- function(q) {
return(as.numeric(sub('.', '', unlist(strsplit(q, split='_'))[3])))
}
survey %>%
mutate(question = parse_question(question)) %>%
head()
survey %>%
mutate(question = parse_question(question)) %>%
mutate(numeric_final = ifelse(question %in% reverse_items, 6-numeric, numeric)) %>%
head()
survey %>%
mutate(question = parse_question(question)) %>%
mutate(numeric_final = ifelse(question %in% reverse_items, 6-numeric, numeric)) %>%
arrange(subject) %>%
head()
survey %>%
# mutate(question = parse_question(question)) %>%
# mutate(numeric_final = ifelse(question %in% reverse_items, 6-numeric, numeric)) %>%
arrange(subject) %>%
head()
survey %>%
# mutate(question = parse_question(question)) %>%
# mutate(numeric_final = ifelse(question %in% reverse_items, 6-numeric, numeric)) %>%
arrange(subject) %>%
tail()
parse_question(cog_effort_q16)
parse_question('cog_effort_q16')
head(survey)
parse_question(unique(survey$question))
Vectorize(parse_question)(unique(survey$question))
survey %>%
mutate(question = Vectorize(parse_question)(question)) %>%
mutate(numeric_final = ifelse(question %in% reverse_items, 6-numeric, numeric)) %>%
arrange(subject) %>%
head()
survey %>%
mutate(question = Vectorize(parse_question)(question)) %>%
mutate(numeric_final = ifelse(question %in% reverse_items, 6-numeric, numeric)) %>%
arrange(subject) %>%
select(-response, -numeric) %>%
rename(numeric_final = response) %>%
head()
survey %>%
mutate(question = Vectorize(parse_question)(question)) %>%
mutate(numeric_final = ifelse(question %in% reverse_items, 6-numeric, numeric)) %>%
arrange(subject) %>%
select(-response, -numeric) %>%
rename(response = numeric_final) %>%
head()
survey %>%
group_by(subject) %>%
summarize(cog_need = mean(response)) %>%
ggplot(aes(x = cog_need)) +
geom_histogram(color = 'black')
survey %>%
filter(!is.na(response)) %>%
group_by(subject) %>%
summarize(cog_need = mean(response)) %>%
ggplot(aes(x = cog_need)) +
geom_histogram(color = 'black')
head(survey)
reverse_items <- c(3,4,5,7,8,9,12,16,17)
response_code <- data.frame(response = c('neutral', 'somewhat_agree', 'somewhat_disagree', 'strongly_agree', 'strongly_disagree', ''), numeric = c(3, 4, 2, 5, 1, NA))
survey <- demo %>%
gather(question, response, cog_effort_q1:cog_effort_q18) %>%
select(subject, question, response) %>%
inner_join(response_code)
parse_question <- function(q) {
return(as.numeric(sub('.', '', unlist(strsplit(q, split='_'))[3])))
}
survey <- survey %>%
mutate(question = Vectorize(parse_question)(question)) %>%
mutate(numeric_final = ifelse(question %in% reverse_items, 6-numeric, numeric)) %>%
arrange(subject) %>%
select(-response, -numeric) %>%
rename(response = numeric_final)
survey %>%
filter(!is.na(response)) %>%
group_by(subject) %>%
summarize(cog_need = mean(response)) %>%
ggplot(aes(x = cog_need)) +
geom_histogram(color = 'black')
survey %>%
group_by(subject) %>%
summarize(missing = sum(is.na(response)) / nrow(.)) %>%
head()
survey %>%
group_by(subject) %>%
summarize(missing = sum(is.na(response)) / nrow(.)) %>%
hist(missing)
survey %>%
group_by(subject) %>%
summarize(missing = sum(is.na(response)) / nrow(.)) %>%
ggplot(aes(x = missing)) +
geom_histogram(color = 'black')
survey %>%
group_by(subject) %>%
summarize(missing = sum(is.na(response)) / nrow(.)) %>%
ggplot(aes(x = missing)) +
geom_histogram(color = 'black') +
labs(
x = 'Proportion Survey Unanswered',
y = 'Frequency'
)
reverse_items <- c(3,4,5,7,8,9,12,16,17)
response_code <- data.frame(response = c('neutral', 'somewhat_agree', 'somewhat_disagree', 'strongly_agree', 'strongly_disagree', ''), numeric = c(3, 4, 2, 5, 1, NA))
survey <- demo %>%
gather(question, response, cog_effort_q1:cog_effort_q18) %>%
select(subject, question, response) %>%
inner_join(response_code)
parse_question <- function(q) {
return(as.numeric(sub('.', '', unlist(strsplit(q, split='_'))[3])))
}
survey <- survey %>%
mutate(question = Vectorize(parse_question)(question)) %>%
mutate(numeric_final = ifelse(question %in% reverse_items, 6-numeric, numeric)) %>%
arrange(subject) %>%
select(-response, -numeric) %>%
rename(response = numeric_final)
survey %>%
filter(!is.na(response)) %>%
group_by(subject) %>%
summarize(cog_need = mean(response)) %>%
ggplot(aes(x = cog_need)) +
geom_histogram(color = 'black')
survey %>%
group_by(subject) %>%
summarize(missing = sum(is.na(response)) / nrow(.)) %>%
ggplot(aes(x = missing)) +
geom_histogram(color = 'black') +
labs(
x = 'Proportion Survey Unanswered',
y = 'Frequency'
)
cog_need <- survey %>%
filter(!is.na(response)) %>%
group_by(subject) %>%
summarize(cog_need = mean(response))
N
## merge cog need with overall data
d %>%
inner_join(cog_need) %>%
head()
summary(factor(d$direction))
d %>%
group_by(subject, direction) %>%
summarize(ssd = mean(ssd)) %>%
spread(direction, ssd) %>%
mutate(effect = `Harder than Reference` - `Easier than Reference`) %>%
inner_join(d) %>%
group_by(subject) %>%
summarize(effect = unique(effect), cog_need = unique(cog_need)) %>%
ggplot(aes(x = cog_need, y = effect)) +
geom_point()
d %>%
group_by(subject, direction) %>%
summarize(ssd = mean(ssd)) %>%
spread(direction, ssd) %>%
mutate(effect = `Harder than Reference` - `Easier than Reference`) %>%
inner_join(d) %>%
group_by(subject) %>%
summarize(effect = unique(effect), cog_need = unique(cog_need)) %>%
head()
temp <- d %>%
group_by(subject, direction) %>%
summarize(ssd = mean(ssd)) %>%
spread(direction, ssd) %>%
mutate(effect = `Harder than Reference` - `Easier than Reference`) %>%
inner_join(d) %>%
group_by(subject) %>%
summarize(effect = unique(effect), cog_need = unique(cog_need)) %>%
head()
temp
reverse_items <- c(3,4,5,7,8,9,12,16,17)
response_code <- data.frame(response = c('neutral', 'somewhat_agree', 'somewhat_disagree', 'strongly_agree', 'strongly_disagree', ''), numeric = c(3, 4, 2, 5, 1, NA))
survey <- demo %>%
gather(question, response, cog_effort_q1:cog_effort_q18) %>%
select(subject, question, response) %>%
inner_join(response_code)
parse_question <- function(q) {
return(as.numeric(sub('.', '', unlist(strsplit(q, split='_'))[3])))
}
survey <- survey %>%
mutate(question = Vectorize(parse_question)(question)) %>%
mutate(numeric_final = ifelse(question %in% reverse_items, 6-numeric, numeric)) %>%
arrange(subject) %>%
select(-response, -numeric) %>%
rename(response = numeric_final)
survey %>%
filter(!is.na(response)) %>%
group_by(subject) %>%
summarize(cog_need = mean(response)) %>%
ggplot(aes(x = cog_need)) +
geom_histogram(color = 'black')
survey %>%
group_by(subject) %>%
summarize(missing = sum(is.na(response)) / nrow(.)) %>%
ggplot(aes(x = missing)) +
geom_histogram(color = 'black') +
labs(
x = 'Proportion Survey Unanswered',
y = 'Frequency'
)
cog_need <- survey %>%
filter(!is.na(response)) %>%
group_by(subject) %>%
summarize(cog_need_score = mean(response))
## look at it
temp <- d %>%
group_by(subject, direction) %>%
summarize(ssd = mean(ssd)) %>%
spread(direction, ssd) %>%
mutate(effect = `Harder than Reference` - `Easier than Reference`) %>%
inner_join(d) %>%
group_by(subject) %>%
summarize(effect = unique(effect), cog_need_score = unique(cog_need_score)) %>%
head()
## merge cog need with overall data
d <- d %>%
inner_join(cog_need)
## look at it
temp <- d %>%
group_by(subject, direction) %>%
summarize(ssd = mean(ssd)) %>%
spread(direction, ssd) %>%
mutate(effect = `Harder than Reference` - `Easier than Reference`) %>%
inner_join(d) %>%
group_by(subject) %>%
summarize(effect = unique(effect), cog_need_score = unique(cog_need_score)) %>%
head()
ggplot(aes(x = cog_need, y = effect)) +
geom_point()
temp
d %>%
group_by(subject, direction) %>%
summarize(ssd = mean(ssd)) %>%
spread(direction, ssd) %>%
mutate(effect = `Harder than Reference` - `Easier than Reference`) %>%
inner_join(d) %>%
group_by(subject) %>%
summarize(effect = unique(effect), cog_need_score = unique(cog_need_score)) %>%
ggplot(aes(x = cog_need, y = effect)) +
geom_point()
d %>%
group_by(subject, direction) %>%
summarize(ssd = mean(ssd)) %>%
spread(direction, ssd) %>%
mutate(effect = `Harder than Reference` - `Easier than Reference`) %>%
inner_join(d) %>%
group_by(subject) %>%
summarize(effect = unique(effect), cog_need_score = unique(cog_need_score)) %>%
head()
d %>%
group_by(subject, direction) %>%
summarize(ssd = mean(ssd)) %>%
spread(direction, ssd) %>%
mutate(effect = `Harder than Reference` - `Easier than Reference`) %>%
inner_join(d) %>%
group_by(subject) %>%
summarize(effect = unique(effect), cog_need_score = unique(cog_need_score)) %>%
ggplot(aes(x = cog_need_score, y = effect)) +
geom_point()
d %>%
group_by(subject, direction) %>%
summarize(ssd = mean(ssd)) %>%
spread(direction, ssd) %>%
mutate(effect = `Harder than Reference` - `Easier than Reference`) %>%
inner_join(d) %>%
group_by(subject) %>%
summarize(effect = unique(effect), cog_need_score = unique(cog_need_score)) %>%
ggplot(aes(x = cog_need_score, y = effect)) +
geom_point() +
geom_smooth(method = 'lm')
library(ggExtra)
d %>%
group_by(subject, direction) %>%
summarize(ssd = mean(ssd)) %>%
spread(direction, ssd) %>%
mutate(effect = `Harder than Reference` - `Easier than Reference`) %>%
inner_join(d) %>%
group_by(subject) %>%
summarize(effect = unique(effect), cog_need_score = unique(cog_need_score)) %>%
ggplot(aes(x = cog_need_score, y = effect)) +
geom_point() +
geom_smooth(method = 'lm') +
labs(
x = 'Need for Cognition',
y = 'Extent Aligned with Prediction'
) +
ggMarginal(type = 'histogram') +
theme_bw()
## look at it
p <- d %>%
group_by(subject, direction) %>%
summarize(ssd = mean(ssd)) %>%
spread(direction, ssd) %>%
mutate(effect = `Harder than Reference` - `Easier than Reference`) %>%
inner_join(d) %>%
group_by(subject) %>%
summarize(effect = unique(effect), cog_need_score = unique(cog_need_score)) %>%
ggplot(aes(x = cog_need_score, y = effect)) +
geom_point() +
geom_smooth(method = 'lm') +
labs(
x = 'Need for Cognition',
y = 'Extent Aligned with Prediction'
) +
theme_bw()
ggMarginal(p, type = 'histogram')
## look at it
p_data <- d %>%
group_by(subject, direction) %>%
summarize(ssd = mean(ssd)) %>%
spread(direction, ssd) %>%
mutate(effect = `Harder than Reference` - `Easier than Reference`) %>%
inner_join(d) %>%
group_by(subject) %>%
summarize(effect = unique(effect), cog_need_score = unique(cog_need_score))
p <- p_data %>%
ggplot(aes(x = cog_need_score, y = effect)) +
geom_point() +
geom_smooth(method = 'lm') +
labs(
x = 'Need for Cognition',
y = 'Extent Aligned with Prediction'
) +
theme_bw()
ggMarginal(p, type = 'histogram')
library(plotly)
p <- d %>%
group_by(subject, direction) %>%
summarize(ssd = mean(ssd)) %>%
spread(direction, ssd) %>%
mutate(effect = `Harder than Reference` - `Easier than Reference`) %>%
select(subject, effect) %>%
inner_join(d) %>%
group_by(subject) %>%
summarize(effect = unique(effect), cog_need_score = unique(cog_need_score), choice_rt = mean(choice_rt))
ggplot(aes(x = cog_need_score, y = effect)) +
geom_point(frame = choice_rt) +
geom_smooth(method = 'lm') +
labs(
x = 'Need for Cognition',
y = 'Extent Aligned with Prediction'
) +
theme_bw()
p <- d %>%
group_by(subject, direction) %>%
summarize(ssd = mean(ssd)) %>%
spread(direction, ssd) %>%
mutate(effect = `Harder than Reference` - `Easier than Reference`) %>%
select(subject, effect) %>%
inner_join(d) %>%
group_by(subject) %>%
summarize(effect = unique(effect), cog_need_score = unique(cog_need_score), choice_rt = mean(choice_rt)) %>%
ggplot(aes(x = cog_need_score, y = effect)) +
geom_point(frame = choice_rt) +
geom_smooth(method = 'lm') +
labs(
x = 'Need for Cognition',
y = 'Extent Aligned with Prediction'
) +
theme_bw()
d %>%
group_by(subject, direction) %>%
summarize(ssd = mean(ssd)) %>%
spread(direction, ssd) %>%
mutate(effect = `Harder than Reference` - `Easier than Reference`) %>%
select(subject, effect) %>%
inner_join(d) %>%
group_by(subject) %>%
summarize(effect = unique(effect), cog_need_score = unique(cog_need_score), choice_rt = mean(choice_rt)) %>%
head()
p <- d %>%
group_by(subject, direction) %>%
summarize(ssd = mean(ssd)) %>%
spread(direction, ssd) %>%
mutate(effect = `Harder than Reference` - `Easier than Reference`) %>%
select(subject, effect) %>%
inner_join(d) %>%
group_by(subject) %>%
summarize(effect = unique(effect), cog_need_score = unique(cog_need_score), choice_rt = mean(choice_rt)) %>%
ggplot(aes(x = cog_need_score, y = effect)) +
geom_point(aes(frame = choice_rt)) +
geom_smooth(method = 'lm') +
labs(
x = 'Need for Cognition',
y = 'Extent Aligned with Prediction'
) +
theme_bw()
fig <- ggplotly(p)
fig <- fig %>%
animation_opts(
1000, easing = 'elastic', redraw = FALSE
)
fig <- fig %>%
animation_button(
x = 1, xanchor = 'right', y = 0, yanchor = 'bottom'
)
fig <- fig %>%
animation_slider(
currentvalue = list(prefix = 'Choice RT ', font = list(color = 'red'))
)
fig
q()
